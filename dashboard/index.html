<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MY BRAND - Dashboard</title>
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
</head>
<script>
    const token = localStorage.getItem("token");
    if (!token) {
        window.location = "../index.html"
    }
    const credential = JSON.parse(window.localStorage.getItem("user"))
    const comments = JSON.parse(window.localStorage.getItem("comments"));
    const apiUrl = "https://my-brand-api-t81n.onrender.com"
    const allMessagesUrl = `${apiUrl}/contact/messages`;
    const allArticlesApi = `${apiUrl}/articles`
    const createArticleUrl = `${apiUrl}/my-brand/blog/create`
</script>
<body>
<div class="container">
    <aside class="left-nav">
        <div class="logo">
            <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 256 256">
                    <path fill="#FFFFFF"
                          d="M128 20a108 108 0 1 0 108 108A108.12 108.12 0 0 0 128 20m0 192a84 84 0 1 1 84-84a84.09 84.09 0 0 1-84 84"/>
                </svg>
            </div>
            <div class="myBrand">
                RM-BRAND
            </div>
        </div>
        <div class="links">
            <div class="link-1">
                <div class="link-item">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <g fill="none" stroke="#FFFFFF" stroke-width="1.5">
                                <path d="M2.364 12.958c-.38-2.637-.57-3.956-.029-5.083c.54-1.127 1.691-1.813 3.992-3.183l1.385-.825C9.8 2.622 10.846 2 12 2c1.154 0 2.199.622 4.288 1.867l1.385.825c2.3 1.37 3.451 2.056 3.992 3.183c.54 1.127.35 2.446-.03 5.083l-.278 1.937c-.487 3.388-.731 5.081-1.906 6.093C18.276 22 16.553 22 13.106 22h-2.212c-3.447 0-5.17 0-6.345-1.012c-1.175-1.012-1.419-2.705-1.906-6.093z"/>
                                <path stroke-linecap="round" d="M12 15v3"/>
                            </g>
                        </svg>
                    </div>
                    <div>
                        <a href="#dashboard">Dashboard</a>
                    </div>
                </div>
                <div class="link-item">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32">
                            <path fill="#FFFFFF"
                                  d="M4 24h10v2H4zm0-6h10v2H4zm22-4H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h20a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2M6 6v6h20V6zm20 22h-6a2 2 0 0 1-2-2v-6a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2m-6-8v6h6v-6z"/>
                        </svg>
                    </div>
                    <div>
                        <a href="#blog-section">Blog</a>
                    </div>
                </div>
                <div class="link-item">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path fill="#FFFFFF"
                                  d="M4 4h16v12H5.17L4 17.17zm0-2c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm2 10h12v2H6zm0-3h12v2H6zm0-3h12v2H6z"/>
                        </svg>
                    </div>
                    <div>
                        <a href="#message-section">Messages</a>
                    </div>
                </div>
            </div>
            <div class="link-2">
                <div class="link-item">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 1024 1024">
                            <path fill="#FFFFFF"
                                  d="m924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 0 0 9.3-35.2l-.9-2.6a443.74 443.74 0 0 0-79.7-137.9l-1.8-2.1a32.12 32.12 0 0 0-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 0 0-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 0 0-25.8 25.7l-15.8 85.4a351.86 351.86 0 0 0-99 57.4l-81.9-29.1a32 32 0 0 0-35.1 9.5l-1.8 2.1a446.02 446.02 0 0 0-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1c0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 0 0-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0 0 35.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0 0 25.8 25.7l2.7.5a449.4 449.4 0 0 0 159 0l2.7-.5a32.05 32.05 0 0 0 25.8-25.7l15.7-85a350 350 0 0 0 99.7-57.6l81.3 28.9a32 32 0 0 0 35.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35M788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1l74.7 63.9a370.03 370.03 0 0 1-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3l-17.9 97a377.5 377.5 0 0 1-85 0l-17.9-97.2l-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9l-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5l-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5c0-15.3 1.2-30.6 3.7-45.5l6.5-40l-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2l31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3l17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97l38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8l92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176m79.2 255.2A111.6 111.6 0 0 1 512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 0 1 400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 0 1 624 502c0 29.9-11.7 58-32.8 79.2"/>
                        </svg>
                    </div>
                    <div>
                        <a href="#setting-section">Setting</a>
                    </div>
                </div>
                <div class="link-item">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32">
                            <path fill="none" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round"
                                  stroke-width="2" d="M28 16H8m12-8l8 8l-8 8m-9 4H3V4h8"/>
                        </svg>
                    </div>
                    <div>
                        <a onclick="logoutLocalStorage()">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    <section class="main" id="dashboard">
        <div class="main-header">
            <h3>Dashboard</h3>
            <h5>Welcome
                <script>document.write(credential["names"])</script>
            </h5>
        </div>
        <div class="cards">
            <div class="visits-card">
                <div class="card-title">
                    <div>Page interaction</div>
                </div>
                <div class="card-body">
                    <div class="card-subtitle">
                        <div class="number" id="totalInteraction"></div>
                    </div>
                    <div class="stats-graph-down">
                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 2048 2048">
                            <path fill="#F6557E"
                                  d="m1965 1101l-941 941l-941-941l90-90l787 787V0h128v1798l787-787z"/>
                        </svg>
                        17 interaction
                    </div>
                </div>
                <div class="card-footer">
                    <div>vs previous 30 days</div>
                </div>
            </div>
            <div class="visits-card">
                <div class="card-title">
                    <div>Written blog</div>
                </div>
                <div class="card-body">
                    <div class="card-subtitle">
                        <div id="totalArticles" class="number"></div>
                    </div>
                    <div class="stats-graph">
                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 2048 2048">
                            <path fill="#5FEF5C"
                                  d="m1453 499l-90 90l-338-337l-1 1796H896l1-1799l-340 340l-90-90L960 6z"/>
                        </svg>
                        9 visits
                    </div>
                </div>
                <div class="card-footer">
                    <div>vs previous 30 days</div>
                </div>
            </div>
            <div class="visits-card">
                <div class="card-title">
                    <div>Messages</div>
                </div>
                <div class="card-body">
                    <div class="card-subtitle">
                        <div id="totalMessages" class="number"></div>
                    </div>
                    <div class="stats-graph-down">
                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 2048 2048">
                            <path fill="#F6557E"
                                  d="m1965 1101l-941 941l-941-941l90-90l787 787V0h128v1798l787-787z"/>
                        </svg>
                        1 messages
                    </div>
                </div>
                <div class="card-footer">
                    <div>vs previous 30 days</div>
                </div>
            </div>
            <div class="visits-card">
                <div class="card-title">
                    <div>Profile views</div>
                </div>
                <div class="card-body">
                    <div class="card-subtitle">
                        <div class="number">24</div>
                    </div>
                    <div class="stats-graph">
                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 2048 2048">
                            <path fill="#5FEF5C"
                                  d="m1453 499l-90 90l-338-337l-1 1796H896l1-1799l-340 340l-90-90L960 6z"/>
                        </svg>
                        5 visits
                    </div>
                </div>
                <div class="card-footer">
                    <div>vs previous 30 days</div>
                </div>
            </div>
        </div>
        <div class="main-message">
            <div class="recent-title">Recent Message</div>
            <table class="message-table">
                <thead>
                <td>User</td>
                <td>Message</td>
                <td>Status</td>
                <td>Date</td>
                <td colspan="2" style="text-align: center">Actions</td>
                </thead>
            </table>
        </div>
    </section>
    <section id="blog-section">
        <div class="recent-title">Articles</div>
        <div class="main-message">
            <div class="add-button">
                <a id="articleRegisterModel" data-open-modal class="add-project">New blog</a>
            </div>
            <table class="blogs-table">
                <thead>
                <td>TITLE</td>
                <td>CONTENT</td>
                <td>THUMBNAIL</td>
                <td>CREATED AT</td>
                <td>UPDATED AT</td>
                <td colspan="2">ACTIONS</td>
                <td></td>
                </thead>
            </table>
        </div>
    </section>
    <section id="message-section">
        <div class="main-message">
            <div class="recent-title">All messages</div>
            <table id="allMessagesSection">
                <thead>
                <td>User</td>
                <td>Message</td>
                <td>Status</td>
                <td>Date</td>
                <td colspan="2" style="text-align: center">Actions</td>
                </thead>
            </table>
        </div>
    </section>
    <section id="setting-section">
        <div class="main-header">
            <h3>Settings</h3>
            <h5>Edit settings,</h5>
        </div>
        <form class="contact-form">
            <div class="email-input">
                <div><label>Name</label></div>
                <div><label>
                    <input type="text" placeholder="Your name" value="Rene MUCYO">
                </label></div>
            </div>
            <div class="email-input">
                <div><label>User name</label></div>
                <div><label>
                    <input type="text" value="mucyorene" placeholder="example: mucyorene">
                </label></div>
            </div>
            <div class="email-input">
                <div><label>Email</label></div>
                <div><label>
                    <input type="text" value="renemucyo1@gmail.com" placeholder="example@gmail.com">
                </label></div>
            </div>
            <div class="email-input">
                <div><label>Password</label></div>
                <div><label>
                    <input type="password" value="mucyorene" placeholder="example@gmail.com">
                </label></div>
            </div>
            <button type="submit">Send</button>
        </form>
    </section>
</div>
<dialog data-modal class="modal">
    <div class="login-modal">
        <div class="modal-header">
            <div></div>
            <div data-close-modal class="close">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 16 16">
                    <path fill="#F6557E"
                          d="M15.1 3.1L12.9.9L8 5.9L3.1.9L.9 3.1l5 4.9l-5 4.9l2.2 2.2l4.9-5l4.9 5l2.2-2.2l-5-4.9z"/>
                </svg>
            </div>
        </div>
        <form id="login-form" class="login-form"
              enctype="multipart/form-data">
            <div id="login-failed"></div>
            <div class="email-group">
                <label for="blogTitle" class="input-label">Title</label>
                <label for="blogTitle"></label>
                <input id="blogTitle" type="text" class="form-input"
                       placeholder="Write title" autocomplete="false">
                <small></small>
            </div>
            <div class="password-group">
                <div class="email-group">
                    <label for="articleBody" class="input-label">Content</label>
                    <label for="articleBody">
                                <textarea rows="4" cols="4" id="articleBody" class="contentBody"
                                          placeholder="Write article content here !"></textarea>
                    </label>
                    <small></small>
                </div>
            </div>
            <div class="email-group">
                <label for="blogTitle" class="input-label">Thumbnail</label>
                <label for="blogTitle"></label>
                <input id="thumbnail" type="file" name="thumbnail" class="form-input" autocomplete="false">
                <small></small>
            </div>
            <div class="saveButton">
                <button class="login" id="createArticle" type="submit">Publish
                </button>
            </div>
        </form>
    </div>
</dialog>
<dialog id="updateDialog" class="modal">
    <div class="login-modal">
        <div class="modal-header">
            <div></div>
            <div id="closeUpdateDialog" class="close">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 16 16">
                    <path fill="#F6557E"
                          d="M15.1 3.1L12.9.9L8 5.9L3.1.9L.9 3.1l5 4.9l-5 4.9l2.2 2.2l4.9-5l4.9 5l2.2-2.2l-5-4.9z"/>
                </svg>
            </div>
        </div>
        <form id="update-form" class="login-form"
              enctype="multipart/form-data">
            <div id="update-feedback"></div>
            <div class="email-group">
                <label for="blogTitle" class="input-label">Title</label>
                <label for="blogTitle"></label>
                <label for="blogUpdateTitle">
                </label><input id="blogUpdateTitle" type="text" class="form-input"
                               placeholder="Write title" autocomplete="false">
                <small></small>
            </div>
            <div class="password-group">
                <div class="email-group">
                    <label for="articleBody" class="input-label">Content</label>
                    <label for="articleUpdateBody">
                                <textarea rows="4" cols="4" id="articleUpdateBody" class="contentBody"
                                          placeholder="Write article content here !"></textarea>
                    </label>
                    <small></small>
                </div>
            </div>
            <div class="email-group">
                <label for="blogTitle" class="input-label">Thumbnail</label>
                <label for="blogTitle"></label>
                <input id="update-thumbnail" type="file" name="thumbnail" class="form-input" autocomplete="false">
                <small></small>
            </div>
            <div class="saveButton">
                <button class="login" id="updateArticle" type="submit">Update
                </button>
            </div>
        </form>
    </div>
</dialog>
<script>
    const openButton = document.querySelector("[data-open-modal]")
    const closeButton = document.querySelector("[data-close-modal]")
    const modal = document.querySelector("[data-modal]")

    openButton.addEventListener("click", () => {
        modal.showModal()
    })

    closeButton.addEventListener("click", () => {
        modal.close()
    })
</script>
<header class="navigation"></header>
<script>
    let totalInteraction = document.querySelector("#totalInteraction");
    let countArticles = 0;
    const showErrors = (input, message) => {
        const parent = input.parentElement
        parent.classList.add("error")
        parent.classList.remove("success")
        const error = parent.querySelector("small")
        validationName.style = "display:flex;flex-direction:column"
        validationEmail.style = "display:flex;flex-direction:column"
        validationMessage.style = "display:flex;flex-direction:column"
        error.style.color = "red"
        error.textContent = message
    }
    const showSuccess = (input, message) => {
        const parent = input.parentElement
        parent.classList.add("success")
        parent.classList.remove("error")
        const error = parent.querySelector("small")
        validationName.style = "display:flex;flex-direction:column"
        validationEmail.style = "display:flex;flex-direction:column"
        validationMessage.style = "display:flex;flex-direction:column"
        error.style.color = "red"

        error.textContent = message
    }
</script>
<script>
    const deleteArticle = async (id) => {
        const url = `${apiUrl}/articles/removeSingleArticle/${id}`
        const askUser = confirm("Really want to delete this message ? there'll no undo")
        if (askUser) {
            const options = {
                method: "DELETE",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${localStorage.getItem("token")}`
                },
            }
            const deleteResponse = await fetch(url, options)
            if (!deleteResponse.ok) {
                const deleteError = await deleteResponse.json()
                console.log(deleteError)
            }
            if (deleteResponse.ok) {
                const data = await deleteResponse.json()
                console.log(data.message)
                toastMethod(data.message)
            }
        }
    }

    const openDialog = (article) => {
        console.log(typeof article[title])
        // Assuming you have a dialog element with an ID of "updateDialog"
        const dialog = document.getElementById("updateDialog");
        const closeButtonUpdate = document.querySelector("#closeUpdateDialog")
        const updateTitle = document.getElementById("blogUpdateTitle")
        const updateBody = document.getElementById("articleUpdateBody")

        if (dialog) {
            dialog.showModal(); // This opens the dialog
        } else {
            console.error("Dialog element not found.");
        }
        if (closeButtonUpdate) {
            closeButtonUpdate.addEventListener("click", () => {
                dialog.close()
            })
        } else {
            console.error("Close not found")
        }
    };

    async function deleteMessage(id) {
        const deleteApi = `https://my-brand-api-t81n.onrender.com/contact/removeContactMessage/${id}`
        const askUser = confirm("Really want to delete this message ?")
        if (askUser) {
            const options = {
                method: "DELETE",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${localStorage.getItem("token")}`
                },
            }
            const deleteResponse = await fetch(deleteApi, options)
            if (!deleteResponse.ok) {
                const deleteError = await deleteResponse.json()
                console.log(deleteError)
            }
            if (deleteResponse.ok) {
                const data = await deleteResponse.json()
                toastMethod(data.messages)
                console.log(data.messages)
            }
        }
    }

    function editStatusFunc(id) {
        let indexToUpdate = comments.findIndex((obj) => obj.id === id)
        let currentStatus = comments[indexToUpdate].status;
        if (indexToUpdate !== -1) {
            comments[indexToUpdate].status = prompt("Write new status:")
            if (comments[indexToUpdate].status === null) {
                comments[indexToUpdate].status = currentStatus
            } else {
                localStorage.setItem('comments', JSON.stringify(comments));
                window.location.reload()
            }
        } else {
            let status = comments[indexToUpdate].status
        }
    }
</script>
<script>
    const onRecentMessages = document.querySelector(".message-table")
    const onRecentAllMessages = document.querySelector("#allMessagesSection")
    const totalMessages = document.querySelector("#totalMessages")

    // Function to fetch articles from the API
    async function fetchMessages() {
        try {
            const options = {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${localStorage.getItem("token")}`
                },
            }
            const response = await fetch(allMessagesUrl, options);
            if (!response.ok) {
                console.log(response.json())
            }
            const data = await response.json();
            let allMessages = data.messages;
            totalMessages.textContent = `${allMessages.length}`
            countArticles += allMessages.length;
            totalInteraction.textContent = countArticles
            let messages = data.messages.slice(-3).reverse()
            for (let a in allMessages) {
                const dateString = new Date(allMessages[a].createdAt);
                let date = `${dateString.getFullYear()} - ${dateString.getMonth() + 1} - ${dateString.getDate()}`
                const allMessageCard = document.createElement("tr")
                allMessageCard.innerHTML = `
                    <td>${allMessages[a].names}</td>
                    <td>${allMessages[a].message}</td>
                    <td>${allMessages[a].status}</td>
                    <td>${date}</td>
                    <td><button style="color:white;background: green;border: none;border-radius: 5px;padding: .4rem .5rem">Update</button></td>
                    <td><button onClick="deleteMessage('${allMessages[a]._id}')" style="color:white;background: red;border: none;border-radius: 5px;padding: .4rem .5rem">Delete</button></td>
                    `
                onRecentAllMessages.appendChild(allMessageCard)
            }
            for (let i in messages) {
                const dateString = new Date(messages[i].createdAt);
                let date = `${dateString.getDate()}/${dateString.getMonth() + 1}/${dateString.getFullYear()}`
                const messageCard = document.createElement("tr")
                messageCard.innerHTML = `
                    <td style="font-weight: bold; padding: 1rem">${messages[i].names}</td>
                    <td style="text-align: justify; padding: 5px">${messages[i].message}</td>
                    <td>${messages[i].status}</td>
                    <td>${date}</td>
                    <td><button style="color:white;background: green;border: none;border-radius: 5px;padding: .4rem .5rem">Update</button></td>
                    <td><button onClick="deleteMessage('${messages[i]._id}')" style="color:white;background: red;border: none;border-radius: 5px;padding: .4rem .5rem">Delete</button></td>
                    `
                onRecentMessages.appendChild(messageCard)
            }
        } catch (error) {
            console.error('Error fetching articles:', error);
        }
    }

    fetchMessages()
</script>
<script>
    const blogDiv = document.querySelector(".blogs-table")
    const totalArticles = document.querySelector("#totalArticles")
    const fetchBlogs = async () => {
        try {
            const response = await fetch(allArticlesApi)
            if (!response.ok) {
                const errors = response.json()
                console.log(errors)
            }
            if (response.ok) {
                const data = await response.json()
                totalArticles.textContent = data.articles.length;
                let totalArts = data.articles;
                totalArts.forEach(article => {
                    countArticles += article.comments.length;
                });
                totalInteraction.textContent = `${countArticles}`
                let articles = data.articles.slice(-10)
                for (let b in articles.reverse()) {

                    const createdDated = new Date(articles[b].createdAt);
                    let createdAt = `${createdDated.getFullYear()}/${createdDated.getMonth() + 1}/${createdDated.getDate()}`

                    const updatedDate = new Date(articles[b].createdAt);
                    let updatedAt = `${updatedDate.getDate()}/${updatedDate.getMonth() + 1}/${updatedDate.getFullYear()}`

                    const blogCard = document.createElement("tr")
                    blogCard.innerHTML = `
                        <td style="text-align: justify; padding: 1rem;font-weight: bold">${articles[b].title}</td>
                        <td style="text-align: justify">${articles[b].body}</td>
                        <td>
                        <img src="${articles[b].thumbnail}" height=50 width=100 alt="">
                        </td>
                        <td>${createdAt}</td>
                        <td>${updatedAt}</td>
                        <td><button onclick="openDialog('${articles[b]}')" data-update-model id="updateArticleDialog" style="color:white;background: green;border: none;border-radius: 5px;padding: .4rem .5rem">Update</button></td>
                        <td><button onClick="deleteArticle('${articles[b]._id}')" style="color:white;background: red;border: none;border-radius: 5px;padding: .4rem .5rem">Delete</button></td>
                        `
                    blogDiv.appendChild(blogCard)
                }
            }
        } catch (error) {
            console.log(error)
        }
    }
    fetchBlogs()
</script>
<script>
    const logoutLocalStorage = () => {
        localStorage.removeItem("token")
        window.location = "../index.html"
    }
</script>
<script>
    let registerArticle = document.querySelector("#login-form")
    let feedbackMessage = document.querySelector("#login-failed")
    let createArticleButton = document.querySelector("#createArticle")

    let title = document.querySelector("#blogTitle")
    let content = document.querySelector("#articleBody")
    let image = document.querySelector("#thumbnail")

    registerArticle.addEventListener("submit", async (event) => {
        event.preventDefault()

        console.log(image.value)
        if (!image) {
            console.log('Please select a file to upload.');
            return;
        }
        createArticleButton.innerHTML = "Loading..."
        const article = {
            "title": title.value,
            "body": content.value,
            "thumbnail": image
        }
        const options = {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${localStorage.getItem("token")}`
            },
            body: JSON.stringify(article)
        }

        try {
            const response = await fetch(createArticleUrl, options)
            if (!response.ok) {
                feedbackMessage.innerHTML = ""
                createArticleButton.innerHTML = "Publish"
                const error = await response.json()
                let failedMessageAlert = document.createElement("div")
                failedMessageAlert.classList.add("success")
                failedMessageAlert.style = "color:red;"
                failedMessageAlert.innerHTML = `<p>${error.message}</p>`
                feedbackMessage.appendChild(failedMessageAlert)
                console.log(`HERE IS ARTICLE NORMAL ERROR: ${error}`)
            }
            if (response.ok) {
                feedbackMessage.innerHTML = ""
                createArticleButton.innerHTML = "Publish"
                registerArticle.reset()
                const data = await response.json()
                let successMessageAlert = document.createElement("div")
                successMessageAlert.classList.add("success")
                successMessageAlert.style = "color:green;"
                successMessageAlert.innerHTML = `<p>${data.message}</p>`
                feedbackMessage.appendChild(successMessageAlert)
            }
        } catch (error) {
            createArticleButton.innerHTML = "Publish"
            console.log(`Error here in article create: ${error}`)
        }
    })
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script>
    function toastMethod(message) {
        Toastify({
            text: message,
            duration: 3000,
            newWindow: true,
            close: true,
            gravity: "top", // `top` or `bottom`
            position: "right", // `left`, `center` or `right`
            stopOnFocus: true, // Prevents dismissing of toast on hover
            style: {
                background: "linear-gradient(to right, #00b09b, #96c93d)",
            },
            onClick: function () {
            } // Callback after click
        }).showToast();
    }
</script>
<!--<script src="update_model.js"></script>-->
</body>
</html>